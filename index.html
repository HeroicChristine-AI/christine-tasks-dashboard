<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasks Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #1a1a2e; color: #eee; padding: 20px; min-height: 100vh; }
        h1 { text-align: center; margin-bottom: 10px; color: #4ecca3; }
        .subtitle { text-align: center; color: #888; margin-bottom: 30px; font-size: 14px; }
        .nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .nav-btn { padding: 10px 20px; background: #16213e; border: 2px solid #4ecca3; color: #4ecca3; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; }
        .nav-btn:hover, .nav-btn.active { background: #4ecca3; color: #1a1a2e; }
        .section { margin-bottom: 40px; }
        .section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #4ecca3; }
        .section-header h2 { color: #4ecca3; font-size: 20px; }
        .task-card { background: #16213e; border-radius: 12px; padding: 20px; margin-bottom: 15px; border-left: 4px solid #555; transition: all 0.2s; }
        .task-card.priority-high { border-left-color: #e94560; }
        .task-card.priority-medium { border-left-color: #f39c12; }
        .task-card.priority-low { border-left-color: #4ecca3; }
        .task-card:hover { transform: translateX(5px); }
        .task-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .task-title { font-size: 16px; font-weight: 600; color: #fff; flex: 1; }
        .task-badge { font-size: 11px; padding: 4px 10px; border-radius: 12px; background: #333; color: #aaa; }
        .task-badge.pending { background: #e94560; color: white; }
        .task-badge.completed { background: #4ecca3; color: #1a1a2e; }
        .task-badge.in-progress { background: #f39c12; color: #1a1a2e; }
        .task-desc { color: #aaa; font-size: 14px; margin-bottom: 10px; }
        .task-meta { color: #666; font-size: 12px; }
        .task-controls { margin-top: 15px; display: flex; gap: 10px; }
        .task-btn { padding: 8px 16px; background: #333; color: #eee; border: none; border-radius: 6px; cursor: pointer; font-size: 12px; }
        .task-btn:hover { background: #444; }
        .task-btn.complete { background: #4ecca3; color: #1a1a2e; }
        .no-tasks { text-align: center; padding: 40px; color: #888; }
        @media (max-width: 600px) {
            .nav { flex-direction: column; }
        }
    </style>
</head>
<body>
    <h1>Tasks Dashboard</h1>
    <p class="subtitle">Track work between AI and Christine</p>

    <div class="nav">
        <button class="nav-btn active" data-filter="all">All Tasks</button>
        <button class="nav-btn" data-filter="pending">Pending</button>
        <button class="nav-btn" data-filter="christine">Christine's Tasks</button>
        <button class="nav-btn" data-filter="ai">AI's Tasks</button>
    </div>

    <div id="tasksContainer"></div>

    <script>
        let tasksData = [];
        let currentFilter = 'all';

        async function loadTasks() {
            try {
                const response = await fetch('tasks.json?t=' + Date.now());
                tasksData = await response.json();
                tasksData.tasks.sort((a, b) => (b.priority === 'high' ? 1 : 0) - (a.priority === 'high' ? 1 : 0));
                renderTasks();
            } catch (error) {
                console.error('Error loading tasks:', error);
                document.getElementById('tasksContainer').innerHTML = '<div class="no-tasks">Error loading tasks.</div>';
            }
        }

        function renderTasks() {
            const container = document.getElementById('tasksContainer');
            container.innerHTML = '';

            let filtered = tasksData.tasks;

            if (currentFilter === 'pending') {
                filtered = tasksData.tasks.filter(t => t.status !== 'completed');
            } else if (currentFilter === 'christine') {
                filtered = tasksData.tasks.filter(t => t.owner === 'Christine');
            } else if (currentFilter === 'ai') {
                filtered = tasksData.tasks.filter(t => t.owner === 'AI');
            }

            if (filtered.length === 0) {
                container.innerHTML = '<div class="no-tasks">No tasks found.</div>';
                return;
            }

            filtered.forEach(task => {
                container.appendChild(createTaskCard(task));
            });
        }

        function createTaskCard(task) {
            const card = document.createElement('div');
            card.className = `task-card priority-${task.priority}`;
            card.dataset.id = task.id;
            card.innerHTML = `
                <div class="task-header">
                    <span class="task-title">${task.title}</span>
                    <span class="task-badge ${task.status}">${task.status}</span>
                </div>
                <p class="task-desc">${task.description}</p>
                <p class="task-meta">
                    ${task.due ? 'Due: ' + task.due : ''} ${task.dependsOn ? 'â€¢ Depends on: ' + task.dependsOn : ''}
                </p>
                <div class="task-controls">
                    <button class="task-btn complete" onclick="markComplete('${task.id}')">Complete</button>
                    ${task.status !== 'pending' ? '<button class="task-btn" onclick="resetTask(\'' + task.id + '\')">Reset</button>' : ''}
                </div>
            `;
            return card;
        }

        function markComplete(taskId) {
            const task = tasksData.tasks.find(t => t.id === taskId);
            if (task) {
                task.status = 'completed';
                updateTasksJSON();
            }
        }

        function resetTask(taskId) {
            const task = tasksData.tasks.find(t => t.id === taskId);
            if (task) {
                task.status = 'pending';
                updateTasksJSON();
            }
        }

        function updateTasksJSON() {
            const card = document.querySelector(`[data-id="${tasksData.tasks.find(t => t.status !== 'completed')?.id}"]`);
            if (card) card.style.opacity = '0.5';
        }

        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderTasks();
            });
        });

        loadTasks();
    </script>
</body>
</html>
